<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="bayesian-mark-recapture-with-data-augmentation-in-jags">Bayesian
Mark-Recapture with Data Augmentation in JAGS</h1>
<p>Kyle Rosenblad 3 April 2025</p>
<h2 id="introduction">Introduction</h2>
<p>This is a ‘colleague-facing’ demo showing how I would approach
collaboration with other quantitative ecologists or statisticians.</p>
<p>Mark-recapture models are hierarchical models often used for
estimating population sizes or other population-level parameters like
survival rates. The key insight is that when individuals are caught,
marked, released, and caught again in a subsequent capture event, the
mix of marked and unmarked individuals in the subsequent event gives us
clues as to the size of the population these individuals belong to.</p>
<p>This document demonstrates Bayesian occupancy modeling concepts and
implementation in R using JAGS. We will build a simple “closed
population”, in which we assume that individuals do not leave or enter
our population between capture events. This kind of model provides the
foundation for more complex approaches like open population models or
time-varying capture probabilities.</p>
<p>In this demo, we will:</p>
<ol style="list-style-type: decimal">
<li><p>Simulate data from a simple closed population model–i.e., one
with no individuals lost or gained from the population between recapture
events.</p></li>
<li><p>Fit a model with the same structure to the simulated data using
JAGS with data augmentation (details below).</p></li>
<li><p>Verify that the model’s parameter estimates are close to the true
values.</p></li>
<li><p>Run posterior predictive checks to ensure the model structure is
a reasonable representation of the data-generating process.</p></li>
</ol>
<h2 id="required-packages">Required Packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<h2 id="simulate-closed-population-mark-recapture-data">Simulate Closed
Population Mark-Recapture Data</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># True parameters</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>n_true <span class="ot">&lt;-</span> <span class="dv">200</span>           <span class="co"># true population size</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>n_occasions <span class="ot">&lt;-</span> <span class="dv">5</span>        <span class="co"># number of sampling occasions</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>p_true <span class="ot">&lt;-</span> <span class="fl">0.4</span>           <span class="co"># capture probability (constant in this model)</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># Simulate capture histories</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># Rows are individuals, columns are sampling occasions</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># 1 = captured, 0 = not captured</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co"># Initialize empty capture history matrix to fill later</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co"># with simulated capture data</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_true, <span class="at">ncol =</span> n_occasions)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co"># Simulate captures</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_true) {</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_occasions) {</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    <span class="co"># Each individual has probability p_true of being captured at each occasion</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    z[i, t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, p_true)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  }</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>}</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co"># In real data, we&#39;d only observe individuals that were captured at least once, so </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co"># let&#39;s extract just observed capture histories (individuals caught at least once)</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>ever_caught <span class="ot">&lt;-</span> <span class="fu">apply</span>(z, <span class="dv">1</span>, sum) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>CH_all <span class="ot">&lt;-</span> z[ever_caught, ]</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co"># Number of observed individuals</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>n_observed <span class="ot">&lt;-</span> <span class="fu">nrow</span>(CH_all)</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co"># Peek at a few example histories</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="fu">head</span>(CH_all)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    0    0    0    0    1
## [2,]    1    1    1    1    1
## [3,]    0    1    1    1    1
## [4,]    0    1    1    1    1
## [5,]    0    0    1    0    1
## [6,]    1    0    0    0    0</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;True population size:&quot;</span>, n_true, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## True population size: 200</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Number of observed individuals:&quot;</span>, n_observed, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Number of observed individuals: 188</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Number of sampling occasions:&quot;</span>, n_occasions, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Number of sampling occasions: 5</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Total captures:&quot;</span>, <span class="fu">sum</span>(CH_all), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Total captures: 400</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Observed capture frequencies by occasion:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Observed capture frequencies by occasion:</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">colSums</span>(CH_all)</span></code></pre></div>
<pre><code>## [1] 72 86 81 79 82</code></pre>
<h2 id="data-augmentation-approach">Data Augmentation Approach</h2>
<p>The data augmentation approach adds a set of all-zero capture
histories (representing potential unobserved individuals) to the
observed data. Then we use an indicator parameter, which is part of our
model, to determine whether each individual is part of the
population.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Set the number of augmented individuals (should be much larger than expected N)</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># Create the augmented data set</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>y_aug <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> M, <span class="at">ncol =</span> n_occasions)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>y_aug[<span class="dv">1</span><span class="sc">:</span>n_observed, ] <span class="ot">&lt;-</span> CH_all</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># Create a vector indicating which individuals were actually observed</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co"># (1 for observed, NA for augmented)</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>z_init <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, M)</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>z_init[<span class="dv">1</span><span class="sc">:</span>n_observed] <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># All observed individuals must be in the population</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co"># Prepare data for JAGS</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>jags_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  <span class="at">y =</span> y_aug,            <span class="co"># Augmented capture histories</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="at">M =</span> M,                <span class="co"># Total augmented size</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  <span class="at">n_occasions =</span> n_occasions  <span class="co"># Number of occasions</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>)</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co"># Define sensible places in parameter space for the MCMC sampler chains to begin</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>    <span class="at">z =</span> z_init,</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>    <span class="at">p =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.2</span>, <span class="fl">0.6</span>),</span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>    <span class="at">omega =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>)</span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>  )</span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="jags-model-with-data-augmentation">JAGS Model with Data
Augmentation</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Define the JAGS model</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="st">  # Priors</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="st">  omega ~ dunif(0, 1)        # Inclusion probability (see augmentation above)</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="st">  p ~ dunif(0, 1)            # Capture probability</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="st">  # Latent inclusion state (z=1 if individual is in population, 0 otherwise)</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="st">  for (i in 1:M) {</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="st">    z[i] ~ dbern(omega)      # Inclusion indicator</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="st">    # Observation process - each occasion is a Bernoulli trial</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="st">    for (t in 1:n_occasions) {</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="st">      # Can only be captured if in population (z[i]=1)</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="st">      # The probability is p (capture probability) * z[i] (inclusion indicator)</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="st">      y[i,t] ~ dbern(p * z[i])</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="st">      </span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="st">      # Generate replicate data for posterior predictive check</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="st">      y_sim[i,t] ~ dbern(p * z[i])</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="st">  # Derived parameters</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="st">  N &lt;- sum(z[])               # Population size</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="st">  # Posterior predictive check statistics</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="st">  for (t in 1:n_occasions) {</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="st">    # Observed and simulated counts for each occasion</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="st">    n_obs[t] &lt;- sum(y[1:M,t])</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="st">    n_sim[t] &lt;- sum(y_sim[1:M,t])</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="st">&quot;</span>, <span class="at">file =</span> <span class="st">&quot;augmented_model.jags&quot;</span>)</span></code></pre></div>
<h2 id="run-jags-model">Run JAGS Model</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Parameters to monitor</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;omega&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;n_obs&quot;</span>, <span class="st">&quot;n_sim&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># MCMC settings</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>n.chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>n.iter <span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>n.burnin <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>n.thin <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co"># Run JAGS</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>jags_fit <span class="ot">&lt;-</span> <span class="fu">jags</span>(</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>  <span class="at">data =</span> jags_data,</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>  <span class="at">parameters.to.save =</span> params,</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="at">model.file =</span> <span class="st">&quot;augmented_model.jags&quot;</span>,</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  <span class="at">inits =</span> inits,</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>  <span class="at">n.chains =</span> n.chains,</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="at">n.iter =</span> n.iter,</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>  <span class="at">n.burnin =</span> n.burnin,</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>  <span class="at">n.thin =</span> n.thin</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## module glm loaded

## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 2500
##    Unobserved stochastic nodes: 3002
##    Total graph size: 6028
## 
## Initializing model
## 
##   |                                                          |                                                  |   0%  |                                                          |++++                                              |   8%  |                                                          |++++++++                                          |  16%  |                                                          |++++++++++++                                      |  24%  |                                                          |++++++++++++++++                                  |  32%  |                                                          |++++++++++++++++++++                              |  40%  |                                                          |++++++++++++++++++++++++                          |  48%  |                                                          |++++++++++++++++++++++++++++                      |  56%  |                                                          |++++++++++++++++++++++++++++++++                  |  64%  |                                                          |++++++++++++++++++++++++++++++++++++              |  72%  |                                                          |++++++++++++++++++++++++++++++++++++++++          |  80%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++      |  88%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++  |  96%  |                                                          |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%
##   |                                                          |                                                  |   0%  |                                                          |*                                                 |   3%  |                                                          |***                                               |   5%  |                                                          |****                                              |   8%  |                                                          |*****                                             |  11%  |                                                          |*******                                           |  13%  |                                                          |********                                          |  16%  |                                                          |*********                                         |  19%  |                                                          |***********                                       |  21%  |                                                          |************                                      |  24%  |                                                          |*************                                     |  27%  |                                                          |***************                                   |  29%  |                                                          |****************                                  |  32%  |                                                          |*****************                                 |  35%  |                                                          |*******************                               |  37%  |                                                          |********************                              |  40%  |                                                          |*********************                             |  43%  |                                                          |***********************                           |  45%  |                                                          |************************                          |  48%  |                                                          |*************************                         |  51%  |                                                          |***************************                       |  53%  |                                                          |****************************                      |  56%  |                                                          |*****************************                     |  59%  |                                                          |*******************************                   |  61%  |                                                          |********************************                  |  64%  |                                                          |*********************************                 |  67%  |                                                          |***********************************               |  69%  |                                                          |************************************              |  72%  |                                                          |*************************************             |  75%  |                                                          |***************************************           |  77%  |                                                          |****************************************          |  80%  |                                                          |*****************************************         |  83%  |                                                          |*******************************************       |  85%  |                                                          |********************************************      |  88%  |                                                          |*********************************************     |  91%  |                                                          |***********************************************   |  93%  |                                                          |************************************************  |  96%  |                                                          |************************************************* |  99%  |                                                          |**************************************************| 100%</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">print</span>(jags_fit)</span></code></pre></div>
<pre><code>## Inference for Bugs model at &quot;augmented_model.jags&quot;, fit using jags,
##  3 chains, each with 20000 iterations (first 5000 discarded), n.thin = 10
##  n.sims = 4500 iterations saved
##           mu.vect sd.vect     2.5%      25%      50%      75%    97.5%  Rhat n.eff
## N         205.689   5.315  197.000  202.000  205.000  209.000  217.000 1.001  4500
## n_obs[1]   72.000   0.000   72.000   72.000   72.000   72.000   72.000 1.000     1
## n_obs[2]   86.000   0.000   86.000   86.000   86.000   86.000   86.000 1.000     1
## n_obs[3]   81.000   0.000   81.000   81.000   81.000   81.000   81.000 1.000     1
## n_obs[4]   79.000   0.000   79.000   79.000   79.000   79.000   79.000 1.000     1
## n_obs[5]   82.000   0.000   82.000   82.000   82.000   82.000   82.000 1.000     1
## n_sim[1]   80.299   7.607   66.000   75.000   80.000   86.000   95.000 1.001  4500
## n_sim[2]   80.105   7.600   65.000   75.000   80.000   85.000   95.000 1.001  3100
## n_sim[3]   80.046   7.699   65.000   75.000   80.000   85.000   95.000 1.002  1500
## n_sim[4]   80.254   7.618   65.000   75.000   80.000   85.000   95.000 1.001  4500
## n_sim[5]   80.133   7.666   65.000   75.000   80.000   85.000   95.000 1.001  4500
## omega       0.412   0.024    0.364    0.395    0.411    0.429    0.460 1.001  4500
## p           0.389   0.018    0.354    0.378    0.389    0.401    0.424 1.001  4500
## deviance 1375.114  26.067 1330.606 1356.452 1372.585 1391.229 1428.727 1.001  4500
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 339.8 and DIC = 1714.9
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<h2 id="parameter-recovery-and-diagnostics">Parameter Recovery and
Diagnostics</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Extract MCMC samples</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>mcmc_array <span class="ot">&lt;-</span> jags_fit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.array</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>mcmc_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(jags_fit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.matrix)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co"># Parameter recovery plots</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co"># Plot for capture probability</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="fu">hist</span>(mcmc_df<span class="sc">$</span>p, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">&quot;Posterior of p&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Capture Probability&quot;</span>)</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> p_true, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Posterior&quot;</span>, <span class="st">&quot;True value&quot;</span>), </span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;gray&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co"># Plot for population size</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="fu">hist</span>(mcmc_df<span class="sc">$</span>N, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">&quot;Posterior of N&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Population Size&quot;</span>)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> n_true, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Posterior&quot;</span>, <span class="st">&quot;True value&quot;</span>), </span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;gray&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Traceplots for convergence check - showing all chains</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="fu">dim</span>(mcmc_array)[<span class="dv">2</span>]</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(n_chains)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co"># Traceplot for p</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="fu">plot</span>(mcmc_array[,<span class="dv">1</span>,<span class="st">&quot;p&quot;</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span>colors[<span class="dv">1</span>], </span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Traceplot for p&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;p&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="cf">if</span>(n_chains <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_chains) {</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>    <span class="fu">lines</span>(mcmc_array[,i,<span class="st">&quot;p&quot;</span>], <span class="at">col=</span>colors[i])</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>  }</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>}</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co"># Traceplot for N</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="fu">plot</span>(mcmc_array[,<span class="dv">1</span>,<span class="st">&quot;N&quot;</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span>colors[<span class="dv">1</span>], </span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Traceplot for N&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;N&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Iteration&quot;</span>)</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="cf">if</span>(n_chains <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_chains) {</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>    <span class="fu">lines</span>(mcmc_array[,i,<span class="st">&quot;N&quot;</span>], <span class="at">col=</span>colors[i])</span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>  }</span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Calculate 95% credible intervals</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>p_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mcmc_df<span class="sc">$</span>p, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>N_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mcmc_df<span class="sc">$</span>N, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co"># Print parameter summaries</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Capture probability (p):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Capture probability (p):</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  True value:&quot;</span>, p_true, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   True value: 0.4</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Posterior mean:&quot;</span>, <span class="fu">mean</span>(mcmc_df<span class="sc">$</span>p), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   Posterior mean: 0.3894743</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  95% credible interval:&quot;</span>, p_ci[<span class="dv">1</span>], <span class="st">&quot;to&quot;</span>, p_ci[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   95% credible interval: 0.3539206 to 0.4241627</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  True value in 95% CI:&quot;</span>, p_true <span class="sc">&gt;=</span> p_ci[<span class="dv">1</span>] <span class="sc">&amp;</span> p_true <span class="sc">&lt;=</span> p_ci[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   True value in 95% CI: TRUE</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Population size (N):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Population size (N):</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  True value:&quot;</span>, n_true, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   True value: 200</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Posterior mean:&quot;</span>, <span class="fu">mean</span>(mcmc_df<span class="sc">$</span>N), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   Posterior mean: 205.6887</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  95% credible interval:&quot;</span>, N_ci[<span class="dv">1</span>], <span class="st">&quot;to&quot;</span>, N_ci[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   95% credible interval: 197 to 217</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  True value in 95% CI:&quot;</span>, n_true <span class="sc">&gt;=</span> N_ci[<span class="dv">1</span>] <span class="sc">&amp;</span> n_true <span class="sc">&lt;=</span> N_ci[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>##   True value in 95% CI: TRUE</code></pre>
<h2 id="posterior-predictive-checks">Posterior Predictive Checks</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># Extract observed vs simulated counts from the matrix format</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(mcmc_df), <span class="at">ncol =</span> n_occasions)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(mcmc_df), <span class="at">ncol =</span> n_occasions)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_occasions) {</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  n_obs[, t] <span class="ot">&lt;-</span> mcmc_df[, <span class="fu">paste0</span>(<span class="st">&quot;n_obs[&quot;</span>, t, <span class="st">&quot;]&quot;</span>)]</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>  n_sim[, t] <span class="ot">&lt;-</span> mcmc_df[, <span class="fu">paste0</span>(<span class="st">&quot;n_sim[&quot;</span>, t, <span class="st">&quot;]&quot;</span>)]</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>}</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a><span class="co"># Calculate means and 95% CI for simulated counts</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>n_sim_mean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(n_sim)</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>n_sim_lower <span class="ot">&lt;-</span> <span class="fu">apply</span>(n_sim, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, <span class="fl">0.025</span>))</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>n_sim_upper <span class="ot">&lt;-</span> <span class="fu">apply</span>(n_sim, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, <span class="fl">0.975</span>))</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a><span class="co"># Observed counts from data</span></span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>obs_counts <span class="ot">&lt;-</span> <span class="fu">colSums</span>(CH_all)</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a><span class="co"># Plot observed vs simulated</span></span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>n_occasions, obs_counts, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(n_sim_upper) <span class="sc">*</span> <span class="fl">1.1</span>),</span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Sampling Occasion&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Number of Captures&quot;</span>,</span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Posterior Predictive Check: Captures by Occasion&quot;</span>)</span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>n_occasions, n_sim_mean, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a><span class="co"># Add 95% CI</span></span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n_occasions, <span class="fu">rev</span>(<span class="dv">1</span><span class="sc">:</span>n_occasions)),</span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a>        <span class="fu">c</span>(n_sim_lower, <span class="fu">rev</span>(n_sim_upper)),</span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>))</span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Simulated (mean)&quot;</span>, <span class="st">&quot;95% PI&quot;</span>),</span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">15</span>, <span class="cn">NA</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="cn">NA</span>),</span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># Calculate Bayesian p-value for each occasion</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_occasions)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_occasions) {</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  p_values[t] <span class="ot">&lt;-</span> <span class="fu">mean</span>(n_sim[, t] <span class="sc">&gt;=</span> n_obs[, t])</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Occasion&quot;</span>, t, <span class="st">&quot;- Bayesian p-value:&quot;</span>, p_values[t], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Occasion 1 - Bayesian p-value: 0.8708889 
## Occasion 2 - Bayesian p-value: 0.234 
## Occasion 3 - Bayesian p-value: 0.4748889 
## Occasion 4 - Bayesian p-value: 0.5922222 
## Occasion 5 - Bayesian p-value: 0.422</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Calculate Bayesian p-value for total captures</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>total_obs <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(n_obs)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>total_sim <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(n_sim)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>p_value_total <span class="ot">&lt;-</span> <span class="fu">mean</span>(total_sim <span class="sc">&gt;=</span> total_obs)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Bayesian p-value (total captures):&quot;</span>, p_value_total, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Bayesian p-value (total captures): 0.5184444</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># Plot total captures</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">hist</span>(total_sim, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">&quot;Posterior Predictive Check: Total Captures&quot;</span>,</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Total Simulated Captures&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">sum</span>(obs_counts), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Simulated&quot;</span>, <span class="st">&quot;Observed&quot;</span>),</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<h2 id="summary-and-interpretation">Summary and Interpretation</h2>
<p>We simulated data from a closed population mark-recapture model with:
- Population size (N) = 200 - Capture probability (p) = 0.4 - 5 sampling
occasions</p>
<p>Our JAGS model with data augmentation approach successfully recovered
two of the simulation’s parameter values.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Capture probability</strong>: The posterior mean was
close to the true value, and the true value was within the 95% credible
interval.</p></li>
<li><p><strong>Population size</strong>: The posterior mean was close to
the true value, and the true value was within the 95% credible
interval.</p></li>
</ol>
<p>The posterior predictive checks suggest the observed data would not
be unusual as outputs from our model. i.e., our model seems to represent
the data generating process well. - The observed number of captures at
each occasion falls well within the 95% credible intervals of the
simulated values. - The Bayesian p-values are close to 0.5, indicating a
good fit.</p>
<p>The data augmentation approach provides a robust framework for
implementing mark-recapture models in JAGS, allowing for proper
estimation of population size and capture probability. Many extensions
are possible. These will be explored in future demos.</p>

</body>
</html>
